(this["webpackJsonpreact-sandbox"]=this["webpackJsonpreact-sandbox"]||[]).push([[0],{80:function(t,e,n){"use strict";n.r(e),n.d(e,"app",(function(){return se})),n.d(e,"chatRef",(function(){return oe}));var r,c,a,i,s,o,d,u,j,l,b,O,h,x,p,g,f,m,v,C,w=n(1),k=n.n(w),y=n(42),D=n.n(y),M=n(53),S=n(7),I=n(36),L=n(8),Y=n(20),N=n(11),A="/top",B="/redux-page1",H="/redux-page2",P="/redux-thunk-page1",T="/fire-base-page1",F=n(2),R=function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Y.b,{to:A,children:"Top"}),Object(F.jsx)(Y.b,{to:B,children:"Page1"}),Object(F.jsx)(Y.b,{to:H,children:"Page2"})]})},U=n(14),_=function(){return{dispatch:Object(I.b)()}},z=n(16),E=I.c,G=Object(z.b)({name:"counter",initialState:0,reducers:{increment:function(t){1},decrement:function(t){1},incrementByAmount:function(t,e){e.payload}}}),J=G.actions,K=J.increment,X=J.decrement,q=J.incrementByAmount,Q=function(){return{count:E((function(t){return t.counter}))}},V=G.reducer,W=function(){var t=_().dispatch,e=Q().count,n=Object(w.useState)(2),r=Object(U.a)(n,2),c=r[0],a=r[1];return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{children:"Page1"}),Object(F.jsx)("button",{onClick:function(){return t(K())},children:"\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8"}),Object(F.jsx)("button",{onClick:function(){return t(X())},children:"\u30c7\u30af\u30ea\u30e1\u30f3\u30c8"}),Object(F.jsx)("input",{value:c,onChange:function(t){return a(Number(t.target.value))}}),Object(F.jsx)("button",{onClick:function(){return t(q(c))},children:"\u6570\u5024\u5206\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8"}),Object(F.jsx)("div",{children:e})]})},Z=function(){var t=_().dispatch,e=Q().count,n=Object(w.useState)(2),r=Object(U.a)(n,2),c=r[0],a=r[1];return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{children:"Page2"}),Object(F.jsx)("button",{onClick:function(){return t(K())},children:"\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8"}),Object(F.jsx)("button",{onClick:function(){return t(X())},children:"\u30c7\u30af\u30ea\u30e1\u30f3\u30c8"}),Object(F.jsx)("input",{value:c,onChange:function(t){return a(Number(t.target.value))}}),Object(F.jsx)("button",{onClick:function(){return t(q(c))},children:"\u6570\u5024\u5206\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8"}),Object(F.jsx)("div",{children:e})]})},$=function(){return Object(F.jsx)("div",{children:"Top"})},tt=n(26),et=n.n(tt),nt=(n(78),n(12)),rt=function(){for(var t=et()(),e=[],n=0;n<60;n++){var r="";r=n<10?"0"+n:"".concat(n),e[n]={user_name:"\u3064\u3080\u304e",text:"".concat(n+1),createdAt:t.format("YYYY-MM-DD HH:mm:".concat(r)),order:n+1}}Object(nt.i)(oe,e)},ct=Object(z.b)({name:"latestChatOrder",initialState:0,reducers:{setLatestChatOrder:function(t,e){return e.payload}}}),at=ct.reducer,it=ct.actions.setLatestChatOrder,st=function(){var t=Object(w.useState)(""),e=Object(U.a)(t,2),n=e[0],r=e[1],c=Object(w.useState)(""),a=Object(U.a)(c,2),i=a[0],s=a[1],o=Object(w.useState)(!1),d=Object(U.a)(o,2),u=d[0],j=d[1],l={latestChatOrder:E((function(t){return t.latestChatOrder}))}.latestChatOrder;return Object(F.jsxs)(ot,{children:[Object(F.jsx)(dt,{children:"\u30e6\u30fc\u30b6\u30fc\u540d"}),u?Object(F.jsx)(lt,{children:n}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(ut,{value:n,onChange:function(t){return r(t.target.value)},placeholder:"\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),Object(F.jsx)(jt,{onClick:function(){return function(t){var e=t.setIsLogin;0===t.userName.length?window.alert("\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u5165\u529b\u3057\u306a\u3044\u3068\u30ed\u30b0\u30a4\u30f3\u51fa\u6765\u307e\u305b\u3093"):e(!0)}({setIsLogin:j,userName:n})},children:"\u30ed\u30b0\u30a4\u30f3"})]}),Object(F.jsx)(bt,{children:"\u30c6\u30ad\u30b9\u30c8"}),Object(F.jsx)(Ot,{value:i,onChange:function(t){return s(t.target.value)},placeholder:"\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),Object(F.jsx)(ht,{onClick:function(){return function(t){var e=t.userName,n=t.text,r=t.setText,c=t.isLogin,a=t.latestChatOrder;if(!1===c)window.alert("\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044");else if(0===n.length)window.alert("\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044");else{var i={user_name:e,text:n,createdAt:et()().format("YYYY-MM-DD HH:mm:ss"),order:a+1};Object(nt.f)(oe,i),r("")}}({userName:n,text:i,setText:s,isLogin:u,latestChatOrder:l})},children:"\u30c7\u30fc\u30bf\u8ffd\u52a0"}),Object(F.jsx)(xt,{onClick:rt,children:"\u30b7\u30fc\u30c9\u30c7\u30fc\u30bf\u3067\u30ea\u30bb\u30c3\u30c8"}),Object(F.jsx)(pt,{onClick:function(){Object(nt.i)(oe,{}).catch((function(t){window.alert("\u30c7\u30fc\u30bf\u306e\u524a\u9664\u6642\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f"),console.log(t)}))},children:"\u30c7\u30fc\u30bf\u5168\u524a\u9664"}),Object(F.jsx)(gt,{children:"\u30e6\u30fc\u30b6\u30fc\u540d"}),Object(F.jsx)(ft,{children:"\u30c6\u30ad\u30b9\u30c8"}),Object(F.jsx)(mt,{children:"\u4f5c\u6210\u65e5\u6642"}),Object(F.jsx)(vt,{children:"\u9806\u756a"})]})},ot=L.a.div(r||(r=Object(S.a)(["\n  display: grid;\n  grid-template-columns: 200px 200px 200px 200px;\n  grid-template-rows: 50px 50px 50px 50px;\n"]))),dt=L.a.div(c||(c=Object(S.a)(["\n  grid-column-start: 1;\n  grid-column-end: 2;\n"]))),ut=L.a.input(a||(a=Object(S.a)(["\n  grid-column-start: 2;\n  grid-column-end: 3;\n"]))),jt=L.a.button(i||(i=Object(S.a)(["\n  grid-column-start: 3;\n  grid-column-end: 4;\n"]))),lt=L.a.div(s||(s=Object(S.a)(["\n  grid-column-start: 2;\n  grid-column-end: 4;\n"]))),bt=L.a.div(o||(o=Object(S.a)(["\n  grid-column-start: 1;\n  grid-column-end: 2;\n  grid-row-start: 2;\n  grid-row-end: 3;\n"]))),Ot=L.a.input(d||(d=Object(S.a)(["\n  grid-column-start: 2;\n  grid-column-end: 4;\n  grid-row-start: 2;\n  grid-row-end: 3;\n"]))),ht=L.a.button(u||(u=Object(S.a)(["\n  grid-row-start: 3;\n  grid-row-end: 4;\n"]))),xt=L.a.button(j||(j=Object(S.a)(["\n  grid-column-start: 2;\n  grid-column-end: 3;\n  grid-row-start: 3;\n  grid-row-end: 4;\n"]))),pt=L.a.button(l||(l=Object(S.a)(["\n  grid-column-start: 3;\n  grid-column-end: 4;\n  grid-row-start: 3;\n  grid-row-end: 4;\n"]))),gt=L.a.div(b||(b=Object(S.a)(["\n  grid-column-start: 1;\n  grid-column-end: 2;\n  grid-row-start: 4;\n  grid-row-end: 5;\n"]))),ft=L.a.div(O||(O=Object(S.a)(["\n  grid-column-start: 2;\n  grid-column-end: 3;\n  grid-row-start: 4;\n  grid-row-end: 5;\n"]))),mt=L.a.div(h||(h=Object(S.a)(["\n  grid-column-start: 3;\n  grid-column-end: 4;\n  grid-row-start: 4;\n  grid-row-end: 5;\n"]))),vt=L.a.div(x||(x=Object(S.a)(["\n  grid-column-start: 4;\n  grid-column-end: 5;\n  grid-row-start: 4;\n  grid-row-end: 5;\n"]))),Ct=n(60),wt=n.n(Ct),kt=n(92),yt=Object(z.b)({name:"chatData",initialState:[],reducers:{setChatData:function(t,e){return e.payload}}}),Dt=yt.reducer,Mt=yt.actions.setChatData,St=n(47),It=n(30),Lt=function(t){var e=Object.entries(t||{}).map((function(t){var e=Object(U.a)(t,2);return{key:e[0],value:e[1]}})),n=Object(It.a)(e).reverse(),r=[];return n.map((function(t,e){return r[e]=Object(St.a)(Object(St.a)({},t.value),{},{key:t.key}),0})),r},Yt=Object(z.b)({name:"isChatsCompleted",initialState:!1,reducers:{setIsChatsCompleted:function(t,e){return e.payload}}}),Nt=Yt.reducer,At=Yt.actions.setIsChatsCompleted,Bt=Object(z.b)({name:"hasMore",initialState:!0,reducers:{setHasMore:function(t,e){return e.payload}}}),Ht=Bt.reducer,Pt=Bt.actions.setHasMore,Tt=Object(z.b)({name:"lastChatOrder",initialState:1,reducers:{setLastChatOrder:function(t,e){return e.payload}}}),Ft=Tt.reducer,Rt=Tt.actions.setLastChatOrder,Ut=function(){var t={chatData:E((function(t){return t.chatData}))}.chatData,e={hasMore:E((function(t){return t.hasMore}))}.hasMore,n={isChatsCompleted:E((function(t){return t.isChatsCompleted}))}.isChatsCompleted,r={lastChatOrder:E((function(t){return t.lastChatOrder}))}.lastChatOrder,c=_().dispatch;return function(){var t=_().dispatch,e=Object(nt.g)(oe,Object(nt.e)("order"),Object(nt.c)(40));Object(w.useEffect)((function(){Object(nt.d)(Object(nt.g)(e),(function(e){console.log("\u30c1\u30e3\u30c3\u30c8\u30c7\u30fc\u30bf\u306e\u53d6\u5f97");var n=Lt(e.val());if(t(Mt(n)),0===n.length)t(it(0)),t(Rt(1));else{var r=n[n.length-1];t(it(n[0].order)),t(Rt(r.order))}n.length<40?t(Pt(!1)):t(Pt(!0)),t(At(!0))}))}),[])}(),console.log("\u30c1\u30e3\u30c3\u30c8\u8868\u793a\u9818\u57df\u306e\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0"),Object(F.jsx)(_t,{children:n?Object(F.jsx)(wt.a,{loadMore:function(){return function(t){console.log("loadMore");var e=t.dispatch,n=t.chatData,r=t.lastChatOrder,c=t.hasMore,a=Object(nt.g)(oe,Object(nt.e)("order"),Object(nt.a)(r),Object(nt.c)(11));c&&Object(nt.d)(a,(function(t){console.log("\u30c1\u30e3\u30c3\u30c8\u30c7\u30fc\u30bf\u306e\u53d6\u5f97");var r=Lt(t.val()),c=[].concat(Object(It.a)(n),Object(It.a)(r));if(e(Mt(c)),0!==c.length){var a=c[c.length-1];1===a.order&&(console.log("\u7d42\u308f\u308a"),e(Pt(!1))),e(Rt(a.order))}}),{onlyOnce:!0})}({dispatch:c,chatData:t,lastChatOrder:r,hasMore:e})},hasMore:e,loader:Object(F.jsx)(kt.a,{},0),initialLoad:!1,threshold:50,children:0===t.length?Object(F.jsx)("div",{children:"\u30c1\u30e3\u30c3\u30c8\u306f\u3042\u308a\u307e\u305b\u3093"}):t.map((function(t){return Object(F.jsxs)(zt,{children:[Object(F.jsx)(Et,{children:t.user_name}),Object(F.jsx)(Et,{children:t.text}),Object(F.jsx)(Et,{children:et()(t.createdAt).fromNow()}),Object(F.jsx)(Et,{children:t.order})]},t.key)}))}):Object(F.jsx)(kt.a,{})})},_t=L.a.div(p||(p=Object(S.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),zt=L.a.div(g||(g=Object(S.a)(["\n  display: flex;\n"]))),Et=L.a.div(f||(f=Object(S.a)(["\n  width: 200px;\n"]))),Gt=function(){return et.a.locale("ja"),Object(F.jsxs)(Jt,{children:[Object(F.jsx)(st,{}),Object(F.jsx)(Ut,{})]})},Jt=L.a.div(m||(m=Object(S.a)(["\n  text-align: center;\n"]))),Kt=function(){return Object(F.jsxs)(Xt,{children:[Object(F.jsx)(Y.b,{to:B,children:"Redux"}),Object(F.jsx)(Y.b,{to:P,children:"ReduxThunk"}),Object(F.jsx)(Y.b,{to:T,children:"FireBase"})]})},Xt=L.a.div(v||(v=Object(S.a)(["\n  display: flex;\n  gap: 20px;\n"]))),qt=n(27),Qt=n.n(qt),Vt=n(33),Wt=Object(z.b)({name:"userData",initialState:[],reducers:{setUsers:function(t,e){return e.payload}}}),Zt=Wt.actions.setUsers,$t=Wt.reducer,te=function(){var t={userData:E((function(t){return t.userData}))}.userData,e=_().dispatch;return Object(F.jsxs)("div",{children:[Object(F.jsx)("button",{onClick:function(){return e(function(){var t=Object(Vt.a)(Qt.a.mark((function t(e){var n,r;return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://jsonplaceholder.typicode.com/users");case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,e(Zt(r));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},children:"\u30d5\u30a7\u30c3\u30c1\u30c7\u30fc\u30bf"}),Object(F.jsx)("button",{onClick:function(){return e(Zt([]))},children:"\u30c7\u30fc\u30bf\u30af\u30ea\u30a2"}),t&&t.map((function(t,e){return Object(F.jsx)("div",{children:t.name},e)}))]})},ee=function(){return Object(F.jsx)(Y.b,{to:A,children:"Top"})},ne=function(){return Object(F.jsx)(Y.a,{basename:"/react-sandbox",children:Object(F.jsxs)(N.d,{children:[Object(F.jsxs)(N.b,{exact:!0,path:A,children:[Object(F.jsx)(Kt,{}),Object(F.jsx)($,{})]}),Object(F.jsxs)(N.b,{path:T,children:[Object(F.jsx)(ee,{}),Object(F.jsx)(Gt,{})]}),Object(F.jsxs)(N.b,{path:B,children:[Object(F.jsx)(R,{}),Object(F.jsx)(W,{})]}),Object(F.jsxs)(N.b,{path:H,children:[Object(F.jsx)(R,{}),Object(F.jsx)(Z,{})]}),Object(F.jsxs)(N.b,{path:P,children:[Object(F.jsx)(ee,{}),Object(F.jsx)(te,{})]}),Object(F.jsx)(N.b,{path:"*",children:Object(F.jsx)(N.a,{to:{pathname:A}})})]})})},re=n(40),ce=Object(z.a)({reducer:{counter:V,chatData:Dt,isChatsCompleted:Nt,hasMore:Ht,latestChatOrder:at,lastChatOrder:Ft,userData:$t},middleware:[re.a]}),ae=function(){return Object(F.jsx)(ie,{children:Object(F.jsx)(I.a,{store:ce,children:Object(F.jsx)(ne,{})})})},ie=L.a.div(C||(C=Object(S.a)(["\n    background-color: skyblue;\n    min-height: 100vh;\n"]))),se=Object(M.a)({apiKey:"AIzaSyCLifYdh2b-V9WzIK1X3cL9gRoI_q5UC24",authDomain:"chat-app-86125.firebaseapp.com",databaseURL:"https://chat-app-86125-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"chat-app-86125",storageBucket:"chat-app-86125.appspot.com",messagingSenderId:"717771492231",appId:"1:717771492231:web:4019216ccf20fc5052e122",measurementId:"G-BQCX5GM9PP"}),oe=function(t){var e=Object(nt.b)(t);return Object(nt.h)(e,"chats")}(se);D.a.render(Object(F.jsx)(k.a.StrictMode,{children:Object(F.jsx)(ae,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.ef83ac75.chunk.js.map